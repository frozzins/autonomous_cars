\documentclass[11pt,english]{article} 

%\usepackage[english]{babel}
%\usepackage[utf8]{inputenc}
%\usepackage{amsmath}
%\usepackage{csquotes}% Recommended


\usepackage{fontspec}
\setmainfont{Arial}

\usepackage[a4paper,bindingoffset=1.5cm, left=2cm,right=2.5cm,top=3cm,bottom=4cm, footskip=1.5cm]{geometry}


%  \fontencoding{T1}
%  \fontfamily{arial}
%  \fontseries{m}
%  \fontshape{it}
%  \fontsize{11}
%  \selectfont

\usepackage[caption=false]{subfig}

\usepackage[table,xcdraw]{xcolor}


%\usepackage{geometry} % Required to change the page size to A4
%\geometry{a4paper} % Set the page size to be A4 as opposed to the default US Letter

\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

\linespread{1.5} % Line spacing



%\setlength\parindent{0pt} % Uncomment to remove all indentation from paragraphs

%\graphicspath{{Pictures/}} % Specifies the directory where pictures are stored

%\DeclareGraphicsExtensions{.pdf,.png,.jpg}

%\graphicspath{{"d:/University of Bristol/Papers/"}{"images/"}}

%\usepackage[style=authoryear-ibid,backend=biber]{biblatex}

%\addbibresource{dissertation_citation_database}% Syntax for version >= 1.2

%\addbibresource{sample.bib}% Syntax for version >= 1.2

\usepackage{natbib}
\bibliographystyle{agsm}



\usepackage{graphicx} % Required for including pictures
\usepackage{epstopdf}
\usepackage{float} % Allows putting an [H] in \begin{figure} to specify the exact location of the figure
\usepackage{wrapfig} % Allows in-line images such as the example fish picture



%\usepackage[authoryear]{natbib}%\usepackage{natbib}
%\bibliographystyle{authordate1}
%\bibliographystyle{unsrtnat}%\bibliographystyle{unsrtna
%\bibliographystyle{unsrt} % vancouver   unsrt   agsm  unsrt
%\usepackage[style=authoryear]{biblatex}

%\usepackage{url}parkin2016understanding

\begin{document}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page

\textsc{\LARGE University...}\\[1.5cm] % Name of your university/college
\textsc{\Large Dissertation...}\\[0.5cm] % Major heading such as course name
\textsc{\large Dissertation...}\\[0.5cm] % Minor heading such as course title

\HRule \\[0.4cm]
{ \huge \bfseries Title...}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
Aleksander \textsc{Wilusz} % Your name
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
Eddie \textsc{Wilson} % Supervisor's Name
\end{flushright}
\end{minipage}\\[4cm]



{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise

%\includegraphics{logouni}\\[1cm] % Include a department/university logo - this will require the graphicx package

\vfill % Fill the rest of the page with whitespace

\end{titlepage}

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

\tableofcontents % Include a table of contents

\newpage % Begins the essay on a new page instead of on the same page as the table of contents 

%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------


\section{Introduction} % Major section
\paragraph{}
Autonomous cars are currently a topic of great interest. Around the world the biggest private companies or government’s initiatives are developing self-driving vehicles (uber, google, britol car citations), competing for new emerging market. Each company focuses efforts in different direction. The companies are either trying to develope an all-round car that could perform in both city and on highways or restrict the usage to particular types of roads (tesla). Or anyhing in between. The most significant commercial initiatives include Google driverless car, Tesla, Uber (). Goverment founded initiatives include Venturer and ...


\paragraph{•}
Background of the problem, context of the research, reasons why the study was carried out, significance of the study



Many experts around the world are trying to predict how autonomous cars will influence our lives. One of the questions is how the traffic itself will change. Most of the experts agree that in the next decades we will observe gradual process of increasing the share of autonomous cars on our roads. In that time human-driven cars and self driving cars will have to successfully interact with each other. According to predictions the fully automated traffic will become reality only around year 2060 or year 2040 in more optimistic predictions and first commercial autonomous cars are already appearing on the roads (singapore, uber). Although there are numerous studies on many aspect of autonomous driving as well as on interactions between regular cars in all-human-traffic there is little research on interactions between these two types of vehicles and all it’s consequences.

\paragraph{•}
A statement of the problem to be addressed

reflect on original Eddie's idea


The focus of this research is to investigate how autonomous cars will influence traffic itself and how human and autonomous cars will interact with each other.




\paragraph{•}
clear and succinct statement of research questions, aims and objectives.


The main aim of the research was trying to predict what will happen when autonomous cars are introduced to the traffic. Results obtained were analysed from the point of view to traffic parameters such as velocities, densities, congestion and from the point of view how individual drivers reacted differently when autonomous vehicle was encountered.

The main objective of the project was to conduct experiments with human drivers and autonomous cars. In the center of the project was a network-based, multi player traffic simulation. Each person participating in the experiment controlled one vehicle and made decisions by observing other traffic participants. By looking into how cars interact with each other it should be possible to extract the impact of self-driving vehicles on the traffic. 



The main objective of the project was to create a an on-line traffic simulation that would allow to connect multiple people together at the same time. People were asked to drive a car 

\paragraph{How scope was reduced}

The original scope of the project included also in-silico implementation that would be using remotely controlled "slot-cars". It was believed that that physical model would have features that could not be accounted for or predicted in computer simulation. It was estimated for around 50\% of implementation effort. However, the final version of the project the physical model was not implemented. After the project went into development the advantages of creating a physical model appeared less and less attractive. Especially compared to the cost of implementation. Original idea assumed using digital slot-car set with cars and track, as well as computer vision to track vehicles on the track and live video streaming to multiple computers. After more careful consideration the benefits of implementing above described would be very minor or none. In addition to this, implementing the computer simulation consumed more time that estimated. 

It has to be admitted that scope was drastically limited in terms of implementation effort. It did not, however, have much impact on the quality of the research and conclusions. One would even venture to say that project should only consist of computer simulation even if more time and resources were allowed for project execution. 

\paragraph{A road map of what is going to be discussed}

The project consisted of three main parts. First one was software development. This accounted for around 50\% of all efforts. The chapter on Research Methodology is mostly dedicated to this. Software section is divided into most significant components that include the design of simulation master, design of client's interface and vehicle's control. The chapter on research methodology also describes how communication between machines was established and the algorithm behind autonomous vehicles. Although these two aspects were integral parts of the software it was decided to write about them separately. It is due to the significance and universality of communication solution and autonomous car algorithm. 
Most of decisions made throughout the development stage were aimed for successful experiment execution. The design of the experiment and how it was eventually conducted are described at the of Research Methodology chapter. 


The Research Methodology chapter is preceded with in-depth chapter describing literature relevant to the project. 

The data obtained during the experiment was described in Findings and Results chapter. This chapter also talks about different ways in which data was analysed. 

The last two closing chapters discuss the results of the experiment, attempt to draw conclusions and generalize findings in wider context. 





\section{Literature review}

There is plenty of literature dedicated to autonomous cars. 


\subsection{Current and future development of autonomous cars}

The prime examples of the most recent achievements in the field of autonomous cars are visible through cutting-edge commercial projects such as google self driving car, uber's and <shanghai something>. Google is probably the most experienced player as it's self driving car project started already in the year 2009 (google self driving car website).
Google's car is classified as level 3 in automated vehicle classification system proposed by NHTSA in 2013 (http://www.nhtsa.gov/About+NHTSA/Press+Releases/U.S.+Department+of+Transportation+Releases+Policy+on+Automated+Vehicle+Development), which is described as "Limited Self-Driving Automation". The car takes full control over all safety-critical functions but at certain times driver can be asked to retake control. 

List of trials on autonomous vehicles is here:
\citep{parkin2016understanding}
googel, volvo, audi, singapore, and add uber


More and more commercially available vehicles feature level 2 of autonomy and are capable of emergency braking, lane control or adaptive cruise control. Even more advanced cars, like Tesla S are able to actively change lanes on a motorway when instructed by driver(link to tesla's manual).


Vehicle classified at level 4 would have to 


Uber is a relatively new player in the business of autonomous cars. 



Write about audi autonomous racing car


In the near future we should be able to see more and more autonomous vehicles on the roads.
The report released by UK Department of Transport titled "The Pathway to Driverless Cars Summary report and action plan" \citep{pathwaytodriverless} states that government recognises the benefits of autonomous vehicles and is undertaking actions to aid the development of technologies and law that would allow to bring driverless cars on public roads. 


\subsection{Implications of autonomous cars revolution}

Experts around the world argue about the consequences of introducing self-driving cars. The report by UK Department of Transport "The Pathway to Driverless Cars" summarizes some main benefits of heaving autonomous cars. Most important points include significant reduction of time spent in vehicles and largely improved safety. It is stayed that an average driver could save up to 6 working weeks of driving time in a single year. A claim on potential safety improvements is backed by existing evidence from automated vehicles that are already commercially available and feature level 2 autonomy. Another important benefits include reduced emission and reduced congestion. Vehicles that are connected into one system would be able to drive in the interest of all traffic participants and therefore greatly optimize traffic. 
A consequence of traffic optimization and overall reduction of Total Kilometers Traveled would be major cost reduction and the result could be increased access to vehicles for everyone\citep{pathwaytodriverless}.


On the other hand, it is argued that autonomous vehicles will not be as robust as expected and traffic parameters will, in fact, worsen\citep{sivak2015road}.

There are also many other indirect implications. As stated in \citep{litman2014autonomous} an example will be a family that decides to settle further from the city because they can spend time in the car productively rather than controlling the vehicle. In consequence the benefits of faster and more optimized travel will be counteracted by overall increase in road demand. Consecutively the traffic parameters may not improve as expected.




Rely heavily on:
\citep{litman2014autonomous}

adittionally:





\subsection{Maximum Capacity Theorem}
Traffic has an ability to self organize close to its capacity. This rule called Fundamental Law of Traffic Congestion or Maximum Capacity Theorem states that when stock of available roads rises, the overall driving increases too \citep{duranton2011fundamental}. The theory behind it explains why building new roads or adding new lanes does not necessary yield proportional decrease in congestion.

Duranton and Turner identified four major sources of additional traffic such as increased commercial traffic, alteration to individual driving behaviour, population growth and diversion from other roads. Raised availability of roads cause an increase in Vehicle Kilometres Travelled(VKT) by commercial vehicles as well as private commuters. Choosing a car as a mean of transport will appear as a more attractive option. 


This theorem could be put in the context of autonomous vehicles. As mentioned before, introducing autonomous cars to the traffic should result in reduced congestion as travelling would be more optimized. However, according to the Fundamental Law of Traffic Congestion, less traffic on the roads can encourage people to travel more. Consequently this will rise overall road demand and the traffic will reach it's new capacity.


\subsection{Conflicts, collisions and interactions on the road}


\citep{parkin2016understanding}

According to (Contributory factors of reported accidents, Great Britain excel) most accidents are caused by human failure. The main contributory factors are failure to look properly, failure to judge other's person speed or path and driver, carelessness, recklessness or being in a hurry.



(writing about it in the context that autonomous cars can potentially improve these things) 


Although the study on conflicts on the road is very complex and hard to quantify according to \citep{risser1985behavior} there are numerous factors that contribute to creating conflicts. These factors include excessive speed or poorly adopted speed, too small distance to proceeding car, violations of the right-of-way and many other types of behaviour. 


More about interactions in general...


\subsection{How people will cooperate with autonomous cars}
In the next decades driverless cars will be required to succesfully cooperate with human drivers. Even when all cars become autonomous , pedestrians, cyclists and other traffic participants must still be able to move around. 
Human driver have certain expectations from other drivers. Things like eye-contact are often important for succesful communication. That kind of interaction will be absent in encounters with autonomous vehicles. Moreover, drivers often posses skills and experience that may not be easy to quantify and program into machine. Therefore driverless cars can, in fact, perform worse in certain situations\citep{sivak2015road}. During transition period the amount of accident can in fact increase.

As mentioned in %https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/401562/pathway-driverless-cars-summary.pdf 
introducing autonomous cars should result in smaller number of accidents. A machine would be free from factors mentioned in previous chapter. 






\subsection{Measuring traffic parameters}

In order to evaluate traffic performance four key parameters will be measured as suggested in a paper by Beymer and McLauchlan \citep{beymer1997real}. 

\begin{itemize}
  \item Flow - Amount of vehicles in one hour (will be separately evaluated for different parts of the track)
  \item Velocity - Average velocity of individual car or multiple cars
  \item Density - Amount of vehicles in for specified distance
  \item Headway - Spacing between vehicles
\end{itemize}

Additionally to the parameters above the traffic will be analysed in terms of amount of accidents.



\subsection{Modelling car behavior}

write about the model in sumo

write how it applied to both human and autonomous

write about possible models of car's behaviours

Inteligent driver model etc

gipps

\subsection{SUMO}

SUMO stands for Simulation of Urban MObility. It's an open source framework used for traffic simulation\citep{krajzewicz2002sumo}. SUMO was first introduced in 2002 and since then it became a popular tool for scientist as well as people involved in practical traffic planning tasks. 

SUMO is a purely microscopic simulation which means every traffic participant is modelled separately. The framework is designed to simulate large cities that contain thousands of roads and more than one million of vehicles.

The core of the SUMO package is a logical representation of road layout. Segments of roads separated by junctions are described as nodes and edges. Edges consist of directed lanes. Vehicle's position is described in terms of edge and lane number and distance from origin node. At every step of the simulation interaction between individual simulation entities are computed and all parameters updated. 
\citep{krajzewicz2002sumo}

SUMO is supported by additional pieces of software such as a tool for importing map structure and a plug-in for providing on-line inputs.

The applications of SUMO include designing traffic light sequence, predicting demands on planned roads or creating traffic control systems.  


It is a microscopic

It allows to account for multiple factors to create 

quick summary of sumo
	


\subsection{Communication between machines - maybe}




\subsection{Experiment design - real world research}






%\cite{parkin2016understanding}
%\parencite{parkin2016understanding}

\citet{parkin2016understanding}

\section{Research Methodology}

The main aim of the project was to look into interactions between autonomous and human-driven vehicles. The main method that was used to achieve this was to create a simulation of traffic with both types of traffic participants. By reviewing the literature it was found that there are numerous car-following models that could be used as a model of human driver. However, no matter how good were these models, they could only work as an approximation of how humans would actually control the cars. It was decided that differences between any of the reviewed car-following algorithms and real human control are so significant that the study should rely on the experiment involving multiple human participants controlling cars in interconnected, on-line simulation.
 
The decision to create such a simulation was a key factor that gave shape to the whole project and accounted for the majority of the time spent on it. 


end here...?


The consequence of heaving an experiment that involved multiple participants was that the major effort was put into developing software that would allow to conduct the experiment. Implementing the simulation was the most significant factor accounting for the complexity of the project. 


Justify the structure of the project. Why the experiment was a key part. Why this was
the best option rather than for example use data from some database?...hmmm

\subsection{Experiment design}
The experiment was arguably the most important part of the project. All work done before was aimed at successful conductance of the experiment and all work done after was based on the data collected during the experiment. 


\textbf{style note:} \textit{This is all written in conditional because it was a plan and actual implementation is a different story??}

The experiment was planned to involve ten to twenty people. They would be asked to control one of the vehicles in the simulation. Each of them would sit in front of a computer where they could use keyboard and observe the screen.  On the screen they would see a top down view of their own vehicle and it's surrounding. By using the keyboard they would control the acceleration of their vehicle.
The instructions given would encourage them to explore the map and avoid collisions with other traffic participants.

The experiment was planned to consist of three main sessions and one learning session. Each session would feature different scenario which determines road layout, number of human-driven cars and number of autonomous cars. During learning session participants would learn(change this word) how to control the car, how car responds to their commands,how to turn and what the environment looked like. 
After learning period the first phase would commence and second afterwards. Both phases would use identical map but the proportion of traditional cars to autonomous would change. The map shape would be an infinity-sign-like where vehicles would have to follow each other and there would be one intersection. It was assumed that such an approach would allow to measure macro parameters of the traffic as both phases would be comparable and the impact of autonomous vehicles could be extracted. The initial choice of measured parameters would include average velocity, density, flow and headway. 
The scenario in the third phase would use significantly more complex map with 3-way  intersections, road exits and road accesses(this sounds wrong?). It would feature a similar number of human-driven and autonomous cars. The focus of the analysis would be microscopic interaction between cars in various road situations. 
Number of autonomous vehicles driving on the map depended on the number of people turning up for the experiment. Additionally map used for phase one and two could be scaled according to the total number of cars.




The instructions given to experiment participants before each phase stated the following:

\begin{enumerate}
  \item Cover as long distance as possible
  \item Avoid collisions with other cars at all cost
  \item Use key described below to control the car
  \item When given a choice to turn at the intersection it's your decision which direction you want to go
  \item Listen to other instructions
\end{enumerate}


At every frame of the simulation  all necessary data was recorded for further analysis. In the event of collision the cars would be allowed to pass through each other. Naturally the event was recorded and collision alert was displayed for drivers involved in the accident. Collisions were unwanted events that were considered a distortions affecting the results. By allowing the cars to pass, the traffic disturbance was mitigated. Another considered ideas such as teleporting vehicles to another place or manually changing the velocities would have greater impact on traffic smoothness. 


The algorithm for the autonomous car was based on Intelligent Driver Model. It is discussed in detail in Software development section. The velocity for autonomous vehicles was capped at 10 m-s but the acceleration was faster than traditional cars.  



(a screenshot from the client gui . Say about control key described, speedometer and collision alert.)



\subsubsection{Client's interface}

The main aim of the graphical interface was to mimic what a person driving a car would actually see from the inside of his or her vehicle. Compared to what a driver sees in real world the representation of the environment had to largely simplified. The challenge was to preserve as much of the realism as possible keeping in mind the main principles of the experiment. The cars were represented as coloured rectangles 2 meters wide and 4.5 meters long. Driver's vehicle was always position in the middle of the screen while map and other vehicles were moving around it. Roads were X? meters wide, coloured in black with red boundaries. Each track was overlaid on graphical background with many distinctive features to allow for better sensation of speed.(reference to website %http://www.sherwoodforestfaire.com/). 


\paragraph{Car control using keyboard}
First things to decide on was how the car was controlled.
Fundamentally the car had one degree of freedom as it always went along a predefined path. Only in the event of road split the driver could make discreet choice on which direction to go.
The acceleration of the car was controlled by A and Z keys. Pressing A made car accelerate with a value calculated from Gipps' car following model discussed in later section. The maximum velocity was capped at 15m-s. Pressing Z key applied constant deceleration of -6.5 m-s2. Additionally drivers could press space bar which functioned as a hand break and applied deceleration of -10 m-s2. These number were found empirically so that car responded realistically (add:? in the subjective opinion of three people). Backward movement was disabled for greater simplification(??).
The reason for not using arrow keys was that arrow key were used to control car's turn direction. Some intersections featured choice between straight, left and right turn. 


\paragraph{Size of view field}
Another design decision concerned the size of driver's view field. The shape and size of the view field was a square 80 meters by 80 meters where car was positioned 20 meters from the bottom as it is showed on figure(number). It was assumed that for a driver travelling at full speed it should be possible to comfortably slow down to zero when a stationary vehicle suddenly appears in front of it. The amount of time elapsing from first sight of the obstacle to coming to full stop includes reaction time and breaking time. According to \citep{summala1998driving} average reaction time for a vehicle without brake lights is about 2 seconds which corresponds to 30 meters travelled. Breaking at -6.5 m-s2 from 15 m-s takes 2.3 seconds which consequently corresponds to 17.2 meters. So the minimal distance that driver should be able to see ahead is 47.2 meters. After initial tests this lower-bound value proved to be too small and after few other trials was extended to 60 meters. Another 20 meters of sight distance was added behind the car. 

(only viewport image)





\subsubsection{Scenarios}

Each scenario specifies configuration of the map, number of human drivers, number of autonomous cars, initial position of each car and length of the simulation. 
While map configuration had to be prepared before, number of vehicles of each type and time of the simulation could be set at the start of the experiment. This flexibility helped to accommodate for unknown number of people that showed up for the experiment. To ensure reasonable congestion but yet high number of interactions each map was intended for different number of vehicles. A benchmark test with solely autonomous cars and additional empirical tests allowed to establish that every vehicle should correspond to 45 to 80 meters of total track length.


In all scenarios participants were not told which car is autonomous and which is controlled by another human. They could, however try to guess the type of the car from how it behaved. 


\subsubsection*{Learning phase}
%\paragraph{Learning how to drive}

(\textit{here im actually talking about using all participants while in fact they were splited into two groups.. . that information would be revelaed later in experiment execution chapter})

The learning period involved all participants and one autonomous car. It lasted 2 to 3 minutes and was intended for getting familiar with the simulation. The data from this period was recorded but was not intended for analysis. In that period participants could ask additional questions. The map used in this scenario is presented on Figure ~\ref{fig:map_0_arrows}.


\begin{figure}[] % Example image
\center{\includegraphics[width=0.8\linewidth]{materials/research_methodology/map_0_arrows.png}}
\caption{Map used in learning scenario. It featured one road exit and one road split. Dimensions are given in meters.}
\label{fig:map_0_arrows}
\end{figure}


\subsubsection*{Scenario 1}

In the first scenario all participants were involved and there was one autonomous car. The map featured figure of eight shape as showed on Figure~\ref{fig:map_1_arrows}. The intersection in the middle was uncontrolled as it did not have any priority rule. It was hoped that this way cars would face uncertain situations and interactions will be more vibrant. This scenario was intended to capture interactions in traffic consisting almost entirely of traditional cars. Interactions were either between cars following each other or between cars at the intersection. It was hoped to observe how people are keeping distance to car ahead, how conflicts at intersection are resolved and what are the potential queueing behaviours.
One autonomous car was added because(why it was added??). Before the simulation started, participants were briefed what is the shape of the map but they were not told how many autonomous cars were in the simulation. This phase was planned to last 4 to 8 minutes depending on the number of participants.


\begin{figure}[] % Example image
\center{\includegraphics[width=0.8\linewidth]{materials/research_methodology/map_1_arrows.png}}
\caption{Map used in First and Second scenario. It featured figure of eight shape. There were no road splits and cars had to follow each other. Dimensions are given in meters. Covering the whole map at full speed of 15m-s would take 22 seconds. The track was intended for 6 to 10 vehicles.}
\label{fig:map_1_arrows}
\end{figure}


\subsubsection*{Scenario 2}

In scenario 2 around 35\% of people taking part in the first scenario was substituted for autonomous cars. This scenario used identical map as scenario 1 (Figure~\ref{fig:map_1_arrows}) and total number of cars didn't change. It was hoped that this way the results will be comparable to first scenario. Particular interest was in the interactions at the intersection. The autonomous cars were always letting human-driven cars go first if collision was anticipated. The humans however didn't know which car is what type and communication happened only via observation of each other's movement. 

Similar to previous scenario the planned length would range between 4 and 8 minutes.


\subsubsection*{Scenario 3}

Scenario 3 aimed at microscopic interaction between particular groups of vehicles. The map used in this scenario featured multiple types of intersections and was much more complex than previous one as it is shown on figure~\ref{fig:map_3_arrows}. The amount of human-controlled cars was equal to the number of autonomous cars. The total density of all vehicles was twice lower than in previous scenarios but because of multiple intersections the number of interactions stayed high.


\begin{figure}[H] % Example image
\center{\includegraphics[width=0.8\linewidth]{materials/research_methodology/map_3_arrows.png}}
\caption{Map used in the third scenario. It featured 2 road splits where drivers could change direction, 2 diagonal intersections,a 3-way intersection and 2 road accesses(?). The total length of all segments was 875 m. Travelling at 15m-s it would take 59 seconds to cover that distance. This was the longest track in the experiment and was designed for 8 to 14 vehicles.}
\label{fig:map_3_arrows}
\end{figure}







\subsection{Software development}

Creating software that allowed to successfully conduct the experiment was the longest and most absorbing part of the project. All decisions starting from the choice of programming environment, through deciding on the structure of the software to ensuring simulation reliability were dictated by the requirements of the experiment.

From the point of view of software implementation the experiment required multiple applications running on multiple machines talking to each other over the network in real-time.




the project required 




//write more intro to software



say how this was not important o avoid cheating as described by Arthur earlier



Justify all major design decisions

Justify all major design decisions. Plenty of them!
All the actions undertaken to ensure most meaningful results


\subsubsection{Environment choice}

Choosing the right environment to develop software was a key decision that had crucial impact on all components of the project. 

After a process of careful consideration it was decided to use MATLAB as a sole development environment for all parts of the project. 

The initial Project Proposal written by Eddie Wilson suggested using SUMO package as a core of the simulation. It was assumed that a small part of SUMO capabilities would be utilized in combinations with additional software written for the purpose of this project. SUMO features  Traffic Control Interface (TraCI) (\textit{link to website}) that gives access to running simulation. The parameters of the simulation like car's location could be potentially retrieved and manipulated in real-time. The additional software would be responsible for data exchange over the network, visualizing car's surrounding and capturing inputs from experiment participants. Most likely the programming language used for this part would be C++.


On the other hand, SUMO was intended for much larger simulations than the one planned. Vast majority of available features would not be used and could rather be a source of potential issues. 

A competing idea was to create a tailored application that would be inspired by the structure of SUMO but would be written from scratch. It would be implemented using C++ or MATLAB environment. The main benefit of this approach would be full control of the software behaviour. The main drawback would be rewriting algorithms and structure that already existed inside SUMO. 

In terms of subjective software preference MATLAB was considered most familiar and least error prone.  

Another key question that had large impact on the decision was how to establish reliable communication between machines. 
It was found that MATLAB supports at least three possible ways of communication that could be used in the project including User Datagram Protocol (UDP), Transmission Control Protocol (TCPIP) and Robot Operating System. This was the main reason why MATLAB was eventually chose for this project.
Details of the implementation of computer-to-computer communication are described in the chapter "Communication between machines".

\subsubsection{Software architecture}


The software in the project consists of three  main parts. The most important one is Simulation Server Application. It is responsible for all data processing that is essential for the simulation. The second piece of software is Simulation Client Application. Each participant used an identical copy of Simulation Client Application to receive information about car's surroundings and send acceleration and direction orders to the server. Last part of the software is Communication Agent which was responsible for aggregating information from all clients and sending it to the server. It's existence was dictated by the requirements of network solution described in further chapters.



\subsubsection{Simulation Server Application design}
//change name of chapter title








\subsubsection{Client Application design}

here combined technical solutions 

General description Simplifications and yet still accounting for most important parts of
the car model

\subsubsection{Car control}

gipps graph here


As the experiment was dedicated to city traffic the maximum velocity was limited to 15 m/s. Starting from full stop and heaving acceleration button pressed the car would reach that velocity after X(?) seconds.


\subsection{Communication between machines}

From one point of view this a tightly coupled with software development but the way
communication was established doesn’t matter from the point of view of software structure.
Simply speaking the comms should only meet some requirements derived from
the main piece of software and the details of implementation doesn’t matter. This was
a significant part of the job and its an achievement on its own.

\subsection{Autonomous car model}





Say why this is important from the point of view of results obtained. Again justify all
design decisions


add Examples of autonomous cars behaviours from experiment. 


\section{Findings and results}


The experiment took place on the 24th of August 2016. 12 people people turned up for the experiment. The group was divided into 2 smaller groups of 6 people each. Once first group completed all tasks, another one was asked to begin. The reasons to split people into two groups were of technical and research nature. A technical problem arose shortly before the experiment was due to to start. It turned out that from participant point of view the simulation gets considerably laggy if there are more that 7 people playing at the same time. The original frame rate was dropping to few frames-per-second which was unacceptable as it would greatly distort the simulation and whole experiment.

From the point of view of experiment methodology heaving two groups conducting identical tasks had beneficial impact on the conclusions that could be drawn from the experiment. It is a common practice to run experiment more than once to detect potential anomalies and have more generalized data(here use Design and Analysis of Experiments," Handbook of Statistics book).



\subsection{Experiment execution}


Experiment was advertised as "Autonomous Cars Simulation". Invitations were sent privately to particular persons. The only information revealed to potential participants stated that experiment will consist of a couple of sessions and they will be asked to drive a car in computer simulation. Participants were promised £10 reward in form of Amazon.com\textsuperscript{\textregistered} voucher and catering available before and after the experiment.


Each of the participants was asked to sit in front of one of selected computers. In front of them there were 3 documents: Consent Form, Participation Information Sheet and Questionnaire. (link to appendixes)
...?

\subsubsection{Questionnaire}

Each of the participants was asked to complete short questionnaire. (link to appendixes). The purpose of the questionnaire was to collect data that later could be used in association with experiment results to create a driving profile for particular person. The exact way in which this data will be used in analysis was not established before the experiment. None the less, it was attempted to ask about things that could have impact on the performance of each person.

The survey consisted of 12 questions which can be divided into 4 categories. There were 2 questions asking about gender and age. Next one asked whether a person played any racing computer games and is familiar with controlling the car with arrow keys. The third section was conditional to the possession of driving licence. If the answer was affirmative, further questions asked about past accidents, subjective evaluation of person's driving style and irritating behaviours they encounter of the roads.
Last question asked about opinion on how the traffic will change when autonomous cars are introduced. 




\subsubsection{Minutes}

The experiment started by reading the Participation Information Sheet to all participants. First paragraph stated rights of experiment participants and how the collected data will be used. Second one explained the task in short and concise way. The exact instructions that were given stated as follows:

"\textit{If you decide to take part in the study, you will be asked to drive a car in on-line traffic simulation. You will be using computer keyboard to control your car. Your main objectives is to cover as long distance as possible and avoid crashing into other cars. There will be 3 phases. Each will last 8 minutes, feature different map and different amount of autonomous vehicles. First phase will be preceded with 3-minute- long learning period when you will be able to learn how to play the game. All additional instructions will be given to you before each phase in form of power point slides. Before starting the simulation you are asked to complete a short survey to describe your driver profile.}"

Rest of the document considered health warnings such as epilepsy and past accidents. Next participants were asked to complete the Questionnaire described above and sign the Consent form. Once that was done they were told once again what is their task, how to control the vehicles and what the next phase will look like. Eventually the main part of the experiment commenced. It consisted of consecutive phases as described it table \ref{table:minutes_table}.


\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Phase} & \textbf{Scenario} & \textbf{Human-driven vehicles} & \textbf{Autonomous vehicles} & \textbf{Lenght} \\ \hline
\multicolumn{5}{|c|}{\textbf{Group 1}}                                                                               \\ \hline
Learning       & Learning          & 6                              & 1                            & 1:45 min        \\ \hline
1              & Scenario 1        & 6                              & 1                            & 3:22 min        \\ \hline
2              & Scenario 2        & 4                              & 3                            & 4:12 min        \\ \hline
3              & Scenario 3        & 4                              & 4                            & 4:09 min        \\ \hline
\multicolumn{5}{|c|}{\textbf{Group 2}}                                                                               \\ \hline
Learning       & Learning          & 6                              & 1                            & 4:33 min        \\ \hline
1              & Scenario 1        & 6                              & 1                            & 4:07 min        \\ \hline
2              & Scenario 2        & 4                              & 3                            & 5:03 min        \\ \hline
3              & Scenario 3        & 4                              & 4                            & 4:51 min        \\ \hline
4 (additional) & Scenario 3        & 6                              & 4                            & 2:24 min        \\ \hline
\end{tabular}
\caption{My caption}
\label{table:minutes_table}
\end{table}

The lengths of each phase were considerably shorter than planned. The initial schedule, however, did not account for heaving two streams of people. 


After the main part of the experiment finished, participants were debriefed and invited for catering. Entire experiment lasted around 1.5 hours and in total 31 minutes of simulation data were harvested.



\subsection{Experiment results}


The analysis of the data could be divided into two parts. First one is dedicated to finding patterns, observing dependencies and evaluating particular group and participants. Second one proposes a range of hypotheses which were consequently tested with proposed methods against the data collected. The discussion of the results was placed in next chapter.

Data collected during the experiment was considerably rich in features and lots of regularities could be potentially found. On average participants changed acceleration/deceleration commands 73 times per minute. 
Figure~\ref{fig:sample_snapshot} shows a snapshot from simulation playback.  
 
 
\begin{figure}[h] % Example image
\center{\includegraphics[width=1\linewidth]{materials/findings_and_results/sample_snapshot2.png}}
\caption{Group 2, phase 3. A snapshot from simulation playback. Cyan colour represents human-driven cars and green represents autonomous cars. A dark blue rectangle represents the view field for one of the cars.}
\label{fig:sample_snapshot}
\end{figure} 
 
 


\subsubsection{Observations}

some text here


\subsubsection*{Decelerations mapping}

First idea that could help to understand the data was to visualize how vehicles accelerated and decelerated. In order to do that a spatial representation of average decelerations was created as it it shown of Figure~\ref{fig:decelerations1}. Track was divided into 4-meters-long segments and for each segment total value of decelerations was summed up over all vehicles and all frames in current phase. Results were plotted for first and second scenario for group 1.


\begin{figure}[h]
\centering
\subfloat[Group 1, Scenario 1]{%
  \includegraphics[clip,width=0.8\linewidth]{materials/findings_and_results/deceleration_scenario_1_group_1.eps}%
}

\subfloat[Group 1, Scenario 2]{%
  \includegraphics[clip,width=0.8\linewidth]{materials/findings_and_results/deceleration_scenario_2_group_1.eps}%
}

\caption{Visual representation of decelerations on map used in first and second scenario. Dark blue represents strong deceleration while light yellow represents weak deceleration. The data was averaged over all vehicles including human-driven and autonomous one.}
\label{fig:decelerations1}
\end{figure}

It can be observed from the plot that once multiple autonomous cars were introduced, vehicles decelerated harder and more often when approaching the intersection.


later: possible reasons: interactions HA were worse



\subsubsection*{Evaluation of participants' performance}

Number of collisions caused by each participant was evaluated and compared against questionnaire responses. Single collision always involved 2 cars. A person responsible was always the one whose car front line intersected the other car first. A number of collisions caused by each person is shown on Figure~\ref{fig:collisions_total}. Table~\ref{table:collisions_table} shows number of collisions against questionnaire responses. Becouse the shorters phase lasted 3:22 minutes, values were calculated only for that period for all phases. From these figures it can be seen that:
\begin{itemize}
  \item Almost every person in the first group performed significantly better in terms of number of collisions than participants from the second group. Because of this reason first group was used more often in further analysis as a sole source of data.
  \item Autonomous cars were responsible for only one collision throughout entire experiment. 
  \item  In total 52 collisions occurred between two human drivers while 33 happened between human drivers and autonomous vehicles. However, accounting for how much each vehicle spent on the track .... ?
\end{itemize}


HH and HA collisions..?

In order to decide who was responsible for

Performance of each participants was evaluated on the basis of 


Heaving two groups of people allowed to find potential anomalies..

asses every participants:


\begin{figure}[h] % Example image
\center{\includegraphics[width=1\linewidth]{materials/findings_and_results/collisions_total.eps}}
\caption{Number of collisions caused by each participant/vehicle in first and second group. (*Humans substituted for autonomous cars in later phases.)}
\label{fig:collisions_total}
\end{figure}




% Please add the following required packages to your document preamble:
% \usepackage[table,xcdraw]{xcolor}
% If you use beamer only pass "xcolor=table" option, i.e. \documentclass[xcolor=table]{beamer}
% \usepackage[normalem]{ulem}
% \useunder{\uline}{\ul}{}
\begin{table}[]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
\textbf{\begin{tabular}[c]{@{}c@{}}Partici-\\ pant\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Familiar with \\ keyboard car \\ control?\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Years of\\ driving\\ experience\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Past \\ accidents\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Driving \\ skill \\ evaluation*\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Driving \\ style**\end{tabular}} & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{\begin{tabular}[c]{@{}c@{}}Collisions \\ (H/A)\end{tabular}}} \\ \hline
\multicolumn{7}{|c|}{\textbf{Group 1}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \\ \hline
1                                                                & Yes                                                                                        & 2                                                                                & 0                                                                  & 2                                                                                & Very careful                                                        & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{1/2}}          \\ \hline
2                                                                & Yes                                                                                        & 1                                                                                & 1                                                                  & 8                                                                                & Careful                                                             & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{4/2}}          \\ \hline
3                                                                & Yes                                                                                        & 5                                                                                & 0                                                                  & 8                                                                                & Normal                                                              & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{0/2}}          \\ \hline
4                                                                & Yes                                                                                        & 6                                                                                & 0                                                                  & 9                                                                                & Careful                                                             & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{2/2}}          \\ \hline
5                                                                & Yes                                                                                        & 5                                                                                & 2                                                                  & 7                                                                                & Careful                                                             & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{3/1}}          \\ \hline
6                                                                & Yes                                                                                        & 2                                                                                & 2                                                                  & 10                                                                               & Normal                                                              & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{2/0}}          \\ \hline
\multicolumn{7}{|c|}{\textbf{Group 2}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \\ \hline
1                                                                & Yes                                                                                        & No licence                                                                                & -                                                                  & -                                                                                & -                                                                   & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{11/5}}         \\ \hline
2                                                                & Yes                                                                                        & 3                                                                                & 1                                                                  & 9                                                                                & Normal                                                              & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{7/6}}         \\ \hline
3                                                                & Yes                                                                                        & 8                                                                                & 0                                                                  & 8                                                                                & Careful                                                             & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{4/5}}          \\ \hline
4                                                                & Yes                                                                                        & 15                                                                               & 3                                                                  & 10                                                                               & Normal                                                              & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{8/5}}         \\ \hline
5                                                                & Yes                                                                                        & 8                                                                                & 2                                                                  & 8                                                                                & Agressive                                                           & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{5/1}}          \\ \hline
6                                                                & Yes                                                                                        & 3                                                                                & 0                                                                  & 1                                                                                & Very careful                                                        & \cellcolor[HTML]{C0C0C0}{\color[HTML]{000000} \textbf{4/1}}          \\ \hline
\end{tabular}
\caption{Questionnaire responses represented against number of collisions caused by each person. It can be observed that self-assessment of driving did not correspond to the number of accidents. (*Own judgement of driving skills on the scale from 1 to 10. **Own judgement of driving style from very careful to very aggressive. Please refer to appendix for details.)}
\label{table:collisions_table}
\end{table}




\subsubsection*{Conflicts resolution}

Interactions between cars can be systematized as one car following another or as a broad range of interactions at intersections. The later was of particular interest because of it's uncertainty and unpredictability. While all maps featured intersections, figure of eight map used in first two scenarios was aimed at more organized analysis and will be used in this example to visualize how humans and autonomous cars made decisions. Figure~\ref{fig:interactions_example_1v2} shows an example of interaction between one human-driven and two autonomous car. In this example both vehicles at the front came to full stop. In ideal situation one vehicle should pass while the other slows down.

//something on conficts reosultion: some paper/ nash equlibrum


//some paper on interaction between autonomous cars



\begin{figure}[!] % Example image
\center{\includegraphics[width=1\linewidth]{materials/findings_and_results/interactions_example_1v2.eps}}
\caption{An example of interaction between two autonomous vehicles and one human-driven. In 204\textsuperscript{th} second both cars started to brake to avoid collision and came to full stop. Human driver was uncertain of how the other car will behave. Autonomous car, on the other hand calculated collision free passage as other vehicle was not moving and starter to move through the intersection in 208\textsuperscript{th} second. Next, human passed through and another autonomous vehicle afterwards. (Colours indicate current order from Participant.)}
\label{fig:interactions_example_1v2}
\end{figure}

Another type are interactions between two autonomous cars as it is shown on Figure~\ref{fig:interactions_example_2}. When two autonomous cars anticipate collision with each other the one which is slower is ordered to reduce its speed according to the time-to-collision value while the faster one passes through uninterrupted. In most cases this relatively simple rule optimizes the interaction reducing braking to minimum.  




%interactions_example_2

//figure of autonomous cars

\begin{figure}[!] % Example image
\center{\includegraphics[width=1\linewidth]{materials/findings_and_results/interactions_example_2.eps}}
\caption{An example of interaction at the intersection between two autonomous vehicles coming from different directions. Both cars anticipated collision in 65\textsuperscript{th} second. In line with the algorithm the slower car started to decelerate as much as it was needed to avoid collision. At each time step new time-to-collision was calculated and velocity adjusted accordingly. The faster car's velocity remained constant.}
\label{fig:interactions_example_2}
\end{figure}





\subsubsection*{Reaction times}


Another topic of interest were reaction times of both types of vehicles. It was anticipated that the rule to always let human driver pass first and potentially faster reaction by autonomous car would have beneficial impact on the traffic. Particular interest was in differences between reaction times of humans and autonomous cars.

//use third map here...


Analysis of reaction times should allow to 


\subsubsection{sth else}


%interactions_example_1


also exmaple of two autonomous cars and two human drivers



part 1: observations:
some interesting graph but no broad idea what for :D

-evaluate group (in terms of number of accidents, questionnaire responses) and which group were in general better - that will justify why you use one group more often

- 

- heatmap of accelerations in figure of eight for two phases...and two groups?
also scenario 3




scenario 1 and 2 (from different groups):
- your nice graph with lines for some h-h, a-a and h-h situations
- eddie's graph for some other situations (or the same)


-reaction times of each driver



%\subsubsection{Hypotheses}

part 2: hypothesis

approach to analysis: hypthoseis


\subsubsection{Hypothesis: Autonomous cars reduce number of accidents}

statement of the hypothesis

Premise: autonomous cars could be better in anticipating collisions


\paragraph{Method of analysis}

what is the method and why it makes sense

Divide crushes to HH and HA. Find who was responsible-explain how you decided on it.

split into intersections and head-on collisions.


\paragraph{Findings}

Describe you you did and what you got as a results


\subsubsection{Hypothesis: Autonomous cars smoothed traffic}

statement of the hypothesis
Premise: autonomous react faster than humans. Find reaction time of humans

\paragraph{Method of analysis}

what is the method and why it makes sense

- calc variance
heat maps for human driven cars - accelerations
- find some particular situations

\paragraph{Findings}

Describe you you did and what you got as a results

\subsubsection{Hypothesis: Most efficient traffic could be achieved with solely autonomous vehicle}

statement of the hypothesis
Premise: autonomous cars show much more optimized reactions between each other compared to interaction h-h or h-a

\paragraph{Method of analysis}

what is the method and why it makes sense

- run trials with only autonomous cars. 7 cars on figure of 8 and 8 cars on scenario 3.
Additionaly enlarge number of vehicles to maximum for figure of 8 (or scenario 3 too?)
-find if velocity reaches some equilibrum..

\paragraph{Findings}

Describe you you did and what you got as a results


\subsubsection{Hypothesis: Interactions were better between two human drivers rather than human and autonomous}

statement of the hypothesis
Premise: autonomous car algorithm make them always give way to humna driver if the collision is anticipated. However, if the human driver will also slow down it might be possible that autonomous car will not anticipate collision any more and will start to move. This can cause another   

\paragraph{Method of analysis}

what is the method and why it makes sense

- run trials with only autonomous cars. 7 cars on figure of 8 and 8 cars on scenario 3.
Additionaly enlarge number of vehicles to maximum for figure of 8 (or scenario 3 too?)
-find if velocity reaches some equilibrum..

\paragraph{Findings}

Describe you you did and what you got as a results






\section{Discussion(of results)}

releta to questionaire reponses..?

relate to all hypotheses and say what the results actually mean.



\section{Conclusions}







%\includegraphics*[100,100][300,300]{mypicture}

%\begin{figure}[H] % Example image
%\center{\includegraphics[width=0.5\linewidth]{placeholder}}
%\caption{Example image.}
%\label{fig:speciation}
%\end{figure}




%------------------------------------------------



%\begin{description} % Numbered list example

%\item[First] \hfill \\


%\item[Second] \hfill \\


%\item[Third] \hfill \\


%\end{description} 

%t

%----------------------------------------------------------------------------------------
%	CONCLUSION
%----------------------------------------------------------------------------------------



%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------


\bibliography{dissertation_citation_database}

%\printbibliography


%\begin{thebibliography}{99} % Bibliography - this is intentionally simple in this template

%\bibitem[Figueredo and Wolf, 2009]{Figueredo:2009dg}
%Figueredo, A.~J. and Wolf, P. S.~A. (2009).
%\newblock Assortative pairing and life history strategy - a cross-cultural
%  study.
%\newblock {\em Human Nature}, 20:317--330.
 
%\end{thebibliography}





%----------------------------------------------------------------------------------------

\end{document}